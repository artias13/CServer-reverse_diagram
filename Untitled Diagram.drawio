<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0" version="24.8.2">
  <diagram name="Page-1" id="z8TMenJuWHfGxh3X5ceK">
    <mxGraphModel dx="1871" dy="499" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="IVjEpb5pE-T4-foRiEZy-24" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-332" y="394" width="408" height="399" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-18" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1659" y="861" width="642" height="540" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-5" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="950" y="475" width="649" height="1150" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-6" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-5">
          <mxGeometry width="649" height="1058.21" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-7" value="void *__thiscall sub_402510(void *this)&lt;br&gt;{&lt;br&gt;&amp;nbsp; HMODULE LibraryA; // eax&lt;br&gt;&amp;nbsp; FARPROC ProcAddress; // eax&lt;br&gt;&amp;nbsp; FARPROC v4; // eax&lt;br&gt;&amp;nbsp; FARPROC v5; // eax&lt;br&gt;&amp;nbsp; FARPROC v6; // eax&lt;br&gt;&amp;nbsp; HMODULE v8; // [esp-Ch] [ebp-10h]&lt;br&gt;&amp;nbsp; HMODULE v9; // [esp-Ch] [ebp-10h]&lt;br&gt;&amp;nbsp; HMODULE v10; // [esp-Ch] [ebp-10h]&lt;br&gt;&amp;nbsp; HMODULE v11; // [esp-Ch] [ebp-10h]&lt;br&gt;&lt;br&gt;&amp;nbsp; *(_DWORD *)this = &amp;amp;off_405728;&lt;br&gt;&amp;nbsp; sub_402800(&amp;amp;unk_4070A8, 128);&lt;br&gt;&amp;nbsp; sub_4028A0(aYf, 13);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aRf8t69mIWm, 27);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aPj, 16);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aDz, 119);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aPj_0, 35);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aPj_1, 57);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;aRfX0wEtbUqP3, 20);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_407328, 67);&lt;br&gt;&amp;nbsp; sub_4028A0(a4zb7SNcj, 36);&lt;br&gt;&amp;nbsp; sub_4028A0(SubKey, 64);&lt;br&gt;&amp;nbsp; sub_4028A0(ValueName, 12);&lt;br&gt;&amp;nbsp; sub_4028A0(aAH, 12);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4073E8, 31);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_407408, 30);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_407428, 32);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_407448, 39);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4071D4, 4);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4071D8, 5);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4071E0, 9);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4071EC, 15);&lt;br&gt;&amp;nbsp; sub_4028A0(&amp;amp;unk_4071FC, 4);&lt;br&gt;&amp;nbsp; sub_4028A0(LibFileName, 12);&lt;br&gt;&amp;nbsp; sub_4028A0(ProcName, 14);&lt;br&gt;&amp;nbsp; sub_4028A0(aXg, 19);&lt;br&gt;&amp;nbsp; sub_4028A0(aXg_0, 17);&lt;br&gt;&amp;nbsp; sub_4028A0(aY, 17);&lt;br&gt;&amp;nbsp; sub_4028A0(aY_0, 17);&lt;br&gt;&amp;nbsp; sub_4028A0(aXg_1, 21);&lt;br&gt;&amp;nbsp; sub_4028A0(aXg_2, 17);&lt;br&gt;&amp;nbsp; sub_4028A0(aXg_3, 20);&lt;br&gt;&amp;nbsp; LibraryA = LoadLibraryA(LibFileName);&lt;br&gt;&amp;nbsp; *((_DWORD *)this + 9) = LibraryA;&lt;br&gt;&amp;nbsp; if ( LibraryA )&lt;br&gt;&amp;nbsp; {&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 1) = GetProcAddress(LibraryA, ProcName);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; ProcAddress = GetProcAddress(*((HMODULE *)this + 9), aXg);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v8 = (HMODULE)*((_DWORD *)this + 9);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 2) = ProcAddress;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v4 = GetProcAddress(v8, aXg_0);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v9 = (HMODULE)*((_DWORD *)this + 9);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 3) = v4;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 4) = GetProcAddress(v9, aY);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v5 = GetProcAddress(*((HMODULE *)this + 9), aY_0);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v10 = (HMODULE)*((_DWORD *)this + 9);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 5) = v5;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v6 = GetProcAddress(v10, aXg_1);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v11 = (HMODULE)*((_DWORD *)this + 9);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 6) = v6;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 8) = GetProcAddress(v11, aXg_2);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; *((_DWORD *)this + 7) = GetProcAddress(*((HMODULE *)this + 9), aXg_3);&lt;br&gt;&amp;nbsp; }&lt;br&gt;&amp;nbsp; return this;&lt;br&gt;}" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-5">
          <mxGeometry x="28.86" y="53" width="500.14" height="992.55" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-16" value="&lt;h1&gt;&lt;b&gt;(function 2, called by function 1 if v1 exists):&lt;/b&gt;&lt;/h1&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-5">
          <mxGeometry x="12" y="15" width="606" height="30" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-9" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" edge="1" parent="1" source="IVjEpb5pE-T4-foRiEZy-13" target="IVjEpb5pE-T4-foRiEZy-6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="574.1999999999998" y="444.53111111111093" as="sourcePoint" />
            <mxPoint x="568" y="706" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1200" y="396" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-10" value="Function_2 call" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="IVjEpb5pE-T4-foRiEZy-9">
          <mxGeometry x="-0.6769" y="-4" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-15" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="221" y="158" width="620" height="1012" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-13" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-15">
          <mxGeometry width="492" height="1012" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-3" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;br&gt;&lt;/h1&gt;&lt;p&gt;void __noreturn sub_401760()&lt;br&gt;{&lt;br&gt;&amp;nbsp; unsigned int v0; // eax&lt;br&gt;&amp;nbsp; void *v1; // eax&lt;br&gt;&amp;nbsp; int v2; // eax&lt;br&gt;&amp;nbsp; unsigned int v3; // esi&lt;br&gt;&amp;nbsp; HANDLE Thread; // eax&lt;br&gt;&amp;nbsp; int v5[2]; // [esp+Ch] [ebp-15E4h] BYREF&lt;br&gt;&amp;nbsp; char Buffer[64]; // [esp+14h] [ebp-15DCh] BYREF&lt;br&gt;&amp;nbsp; struct WSAData WSAData; // [esp+54h] [ebp-159Ch] BYREF&lt;br&gt;&amp;nbsp; _BYTE v8[1024]; // [esp+1E4h] [ebp-140Ch] BYREF&lt;br&gt;&amp;nbsp; char v9[1024]; // [esp+5E4h] [ebp-100Ch] BYREF&lt;br&gt;&amp;nbsp; char v10[1024]; // [esp+9E4h] [ebp-C0Ch] BYREF&lt;br&gt;&amp;nbsp; char v11[2056]; // [esp+DE4h] [ebp-80Ch] BYREF&lt;br&gt;&amp;nbsp; int v12; // [esp+15ECh] [ebp-4h]&lt;br&gt;&lt;br&gt;&amp;nbsp; WSAStartup(0x202u, &amp;amp;WSAData);&lt;br&gt;&amp;nbsp; v0 = time(0);&lt;br&gt;&amp;nbsp; srand(v0);&lt;br&gt;&amp;nbsp; v1 = operator new(0xA8u);&lt;br&gt;&amp;nbsp; v5[1] = (int)v1;&lt;br&gt;&amp;nbsp; v12 = 0;&lt;br&gt;&amp;nbsp; if ( v1 )&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v2 = &lt;font color=&quot;#ff8b26&quot;&gt;sub_402510&lt;/font&gt;(v1); //function_2&lt;br&gt;&amp;nbsp; else&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v2 = 0;&lt;br&gt;&amp;nbsp; v12 = -1;&lt;br&gt;&amp;nbsp; dword_4075BC = v2;&lt;br&gt;&amp;nbsp; &lt;font color=&quot;#baff42&quot;&gt;sub_4027A0&lt;/font&gt;(1, &amp;amp;unk_4075C0); // function_4&lt;br&gt;&amp;nbsp; &lt;font color=&quot;#9cff63&quot;&gt;sub_4027A0&lt;/font&gt;(2, byte_4075E0);&lt;br&gt;&amp;nbsp; while ( 1 )&lt;br&gt;&amp;nbsp; {&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; memset(v10, 0, sizeof(v10));&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; memset(v8, 0, sizeof(v8));&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; memset(v11, 0, 0x800u);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; memset(v9, 0, sizeof(v9));&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v5[0] = 0;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; v3 = sub_402EE0(v10, &amp;amp;unk_4075C0);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; sub_402950(Buffer);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; ProcessDataBuffers(v8, v10, v3);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; sub_402A50(v11, (int)byte_4075E0, (int)v8);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; if ( sub_4034D0(v11, byte_4075E0, Buffer, v9, 1024, v5) &amp;amp;&amp;amp; !strcmp(v9, aStatusSuccess) )&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Thread = CreateThread(0, 0, sub_401960, 0, 0, 0);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; WaitForSingleObject(Thread, 0xFFFFFFFF);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SleepForX(15000);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sub_401C50();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SleepForX(10000);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;&amp;nbsp; }&lt;br&gt;}&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-15">
          <mxGeometry x="9" y="69" width="422.88" height="890" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-25" value="&lt;h1&gt;(function_1 a.k.a main() calls everything else)&lt;br&gt;&lt;/h1&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="IVjEpb5pE-T4-foRiEZy-15">
          <mxGeometry x="-11" y="12" width="631" height="120" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-17" value="&#xa;unsigned int __thiscall sub_4028A0(int this, int a2, unsigned int a3)&#xa;{&#xa;  int v3; // edx&#xa;  unsigned int result; // eax&#xa;  int v5; // ebp&#xa;  unsigned __int8 v6; // cl&#xa;  char v7[128]; // [esp+10h] [ebp-80h] BYREF&#xa;&#xa;  v3 = 0;&#xa;  result = 0;&#xa;  qmemcpy(v7, (const void *)(this + 40), sizeof(v7));&#xa;  v5 = 0;&#xa;  if ( a3 )&#xa;  {&#xa;    do&#xa;    {&#xa;      v3 = (v3 + 1) % 128;&#xa;      v6 = v7[v3];&#xa;      v5 = (v6 + v5) % 128;&#xa;      v7[v3] = v7[v5];&#xa;      v7[v5] = v6;&#xa;      *(_BYTE *)(result + a2) ^= v7[(v6 + (unsigned __int8)v7[v3]) % 128];&#xa;      ++result;&#xa;    }&#xa;    while ( result &lt; a3 );&#xa;  }&#xa;  return result;&#xa;}" style="text;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1700" y="940" width="407" height="440" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-20" value="&lt;h1&gt;(function 3, called by function 2 multiple times):&lt;/h1&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1663" y="888" width="606" height="30" as="geometry" />
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-21" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="IVjEpb5pE-T4-foRiEZy-6" target="IVjEpb5pE-T4-foRiEZy-18">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1670" y="1040" as="sourcePoint" />
            <mxPoint x="1720" y="990" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1980" y="740" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="IVjEpb5pE-T4-foRiEZy-23" value="unsigned int __stdcall sub_4027A0(int a1, char *a2)&#xa;{&#xa;  unsigned int result; // eax&#xa;&#xa;  if ( a1 == 1 )&#xa;  {&#xa;    result = 0;&#xa;    strcpy(a2, aSv);&#xa;  }&#xa;  else&#xa;  {&#xa;    result = a1 - 2;&#xa;    if ( a1 == 2 )&#xa;    {&#xa;      result = strlen(aPxE77y) + 1;&#xa;      qmemcpy(a2, aPxE77y, result);&#xa;    }&#xa;  }&#xa;  return result;&#xa;}" style="text;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-296" y="446" width="312" height="310" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
